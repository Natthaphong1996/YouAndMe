<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Mobile optimized -->
    <title>Counting Down to You (TH üáπüá≠ & JP üáØüáµ)</title>
    <!-- Bootstrap 5.3 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Favicon -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíñ</text></svg>">
</head>

<body>

    <!-- Split Screen Layout -->
    <div class="split-container">

        <!-- Thailand Side (Left/Top) -->
        <div id="th-pane" class="split-side position-relative">
            <div class="split-bg"></div>
            <div class="split-overlay" id="th-overlay"></div>
            <div class="content-wrapper d-flex flex-column justify-content-center align-items-center h-100 p-3 fade-in">
                <div class="d-flex align-items-center mb-1">
                    <i class="fas fa-sun weather-icon me-2 text-warning" id="th-weather"></i>
                    <span class="h1 fw-bold mb-0" id="th-temp">--¬∞C</span>
                </div>
                <h2 class="h4 text-uppercase letter-spacing-2 mb-0">‡∏ö‡∏≤‡∏á‡πÅ‡∏™‡∏ô üèùÔ∏è</h2>
                <div class="display-local-time display-1 fw-light" id="th-clock">--:--</div>
                <small class="badge rounded-pill bg-dark bg-opacity-25" id="th-season">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</small>
            </div>
            <div class="animation-layer th-anim"></div>
        </div>

        <!-- Japan Side (Right/Bottom) -->
        <div id="jp-pane" class="split-side position-relative">
            <div class="split-bg"></div>
            <div class="split-overlay" id="jp-overlay"></div>
            <div
                class="content-wrapper d-flex flex-column justify-content-center align-items-center h-100 p-3 fade-in delay-1">
                <div class="d-flex align-items-center mb-1">
                    <i class="fas fa-moon weather-icon me-2 text-light" id="jp-weather"></i>
                    <span class="h1 fw-bold mb-0" id="jp-temp">--¬∞C</span>
                </div>
                <h2 class="h4 text-uppercase letter-spacing-2 mb-0">‡∏Å‡∏¥‡∏ü‡∏∏ üèØ</h2>
                <div class="display-local-time display-1 fw-light" id="jp-clock">--:--</div>
                <small class="badge rounded-pill bg-dark bg-opacity-25" id="jp-season">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</small>
            </div>
            <div class="animation-layer jp-anim"></div>
        </div>

        <!-- Top Header Bar (Redesigned) -->
        <div
            class="center-piece glass-panel shadow-sm p-2 px-2 px-md-4 fixed-top d-flex flex-column justify-content-between fade-in delay-2">

            <!-- Main Row: Info | Countdown | Actions -->
            <div class="d-flex justify-content-between align-items-center w-100 position-relative"
                style="flex: 1; min-height: 80px;">

                <!-- Left: Spacer (hidden on mobile, keeps symmetry if needed, or just remove) -->
                <!-- Removed Title from here -->

                <!-- Center: Countdown Numbers & Title (Absolutely Centered) -->
                <div
                    class="d-flex flex-column align-items-center justify-content-center position-absolute top-50 start-50 translate-middle w-100">

                    <!-- Numbers Row -->
                    <div class="d-flex gap-3 justify-content-center text-dark align-items-center">
                        <div class="text-center">
                            <span class="d-block h5 d-md-block h3 fw-bold mb-0 lh-1" id="days">0</span>
                            <small class="text-muted" style="font-size: 0.6rem;">‡∏ß‡∏±‡∏ô</small>
                        </div>
                        <div class="text-center">
                            <span class="d-block h5 d-md-block h3 fw-bold mb-0 lh-1" id="hours">0</span>
                            <small class="text-muted" style="font-size: 0.6rem;">‡∏ä‡∏°.</small>
                        </div>
                        <div class="text-center">
                            <span class="d-block h5 d-md-block h3 fw-bold mb-0 lh-1" id="minutes">0</span>
                            <small class="text-muted" style="font-size: 0.6rem;">‡∏ô‡∏≤‡∏ó‡∏µ</small>
                        </div>
                        <div class="text-center">
                            <span class="d-block h5 d-md-block h3 fw-bold mb-0 lh-1" id="seconds">0</span>
                            <small class="text-muted" style="font-size: 0.6rem;">‡∏ß‡∏¥.</small>
                        </div>
                    </div>

                    <!-- Title Below Numbers -->
                    <!-- Title Below Numbers -->
                    <small class="text-uppercase fw-bold mt-2 text-primary small"
                        style="letter-spacing: 1px; font-size: 0.7rem; text-shadow: 0 1px 2px rgba(255,255,255,0.8);">
                        ‡∏ô‡∏±‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á‡∏™‡∏π‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏û‡∏ö‡∏Å‡∏±‡∏ô
                    </small>
                </div>

                <!-- Right: Memories Button -->
                <div class="text-end ms-auto" style="width: auto; z-index: 2;">
                    <button class="btn btn-sm btn-light rounded-pill border shadow-sm text-primary p-1 px-2"
                        data-bs-toggle="modal" data-bs-target="#historyModal">
                        <i class="fas fa-history"></i> <span class="d-none d-md-inline ms-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥</span>
                    </button>
                </div>
            </div>

            <!-- Bottom: Runner Track (Full Width) -->
            <div class="position-relative w-100 mt-3" style="height: 20px;">
                <!-- Track Line -->
                <div class="progress" style="height: 4px; position: absolute; top: 8px; width: 100%; z-index: 1;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-gradient-primary"
                        id="progress-bar" style="width: 0%"></div>
                </div>

                <!-- Runner: You (Left) -->
                <div id="runner-you" class="runner-icon" style="left: 0%; top: -10px;">
                    <i class="fas fa-person-running text-primary"></i> <!-- Default size (small) -->
                </div>

                <!-- Runner: Me (Right) -->
                <div id="runner-me" class="runner-icon" style="right: 0; top: -10px;">
                    <i class="fas fa-person-dress text-danger"></i>
                </div>

                <!-- Heart -->
                <div id="meeting-heart" class="position-absolute start-100 translate-middle text-danger d-none"
                    style="top: 0px;">
                    <i class="fas fa-heart fa-beat"></i>
                </div>
            </div>

            <!-- Message Below Track -->
            <div class="text-center mt-1 pb-1 w-100">
                <p class="mb-0 small fst-italic text-dark text-truncate" id="daily-message"
                    style="text-shadow: 0 0 5px rgba(255,255,255,0.8);">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...</p>
            </div>

            <!-- Hidden Meta -->
            <div class="d-none">
                <span id="progress-text">0%</span>
            </div>
        </div>

    </div>

    <!-- History Modal (Optimized for Mobile) -->
    <div class="modal fade" id="historyModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content glass-panel-light text-dark">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title fw-bold">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="history-list" class="list-group list-group-flush small"></div>
                    <nav class="mt-3">
                        <ul class="pagination pagination-sm justify-content-center mb-0" id="history-pagination"></ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <!-- Dev Tools Toggle (Hidden by default, visible on hover/click in corner) -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 2000;">
        <button class="btn btn-sm btn-dark opacity-50 hover-100 rounded-circle" data-bs-toggle="offcanvas"
            data-bs-target="#devToolsCanvas">
            <i class="fas fa-tools"></i>
        </button>
    </div>

    <!-- Dev Tools Offcanvas -->
    <div class="offcanvas offcanvas-bottom h-50 glass-panel-light text-dark" tabindex="-1" id="devToolsCanvas">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title"><i class="fas fa-magic me-2"></i>‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏Å‡∏≤‡∏® (Theme)</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body small">
            <div class="row g-3">
                <!-- Date Simulation -->
                <div class="col-12 border-bottom pb-3">
                    <label class="form-label fw-bold">‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
                    <div class="input-group">
                        <input type="date" class="form-control" id="sim-date">
                        <button class="btn btn-primary" onclick="window.simulateDate()">‡∏ï‡∏Å‡∏•‡∏á</button>
                        <button class="btn btn-outline-secondary" onclick="window.resetDate()">‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
                    </div>
                </div>

                <!-- Manual Theme Override: TH -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ò‡∏µ‡∏°‡πÑ‡∏ó‡∏¢:</label>
                    <div class="d-flex gap-2 flex-wrap">
                        <button class="btn btn-sm btn-outline-warning"
                            onclick="window.forceTheme('TH', 'summer')">Summer</button>
                        <button class="btn btn-sm btn-outline-info"
                            onclick="window.forceTheme('TH', 'songkran')">Songkran</button>
                        <button class="btn btn-sm btn-outline-primary"
                            onclick="window.forceTheme('TH', 'rainy')">Rainy</button>
                        <button class="btn btn-sm btn-outline-dark" onclick="window.forceTheme('TH', 'loykrathong')">Loy
                            Krathong</button>
                        <button class="btn btn-sm btn-outline-secondary"
                            onclick="window.forceTheme('TH', 'cool')">Cool</button>
                    </div>
                </div>

                <!-- Manual Theme Override: JP -->
                <div class="col-md-6">
                    <label class="form-label fw-bold">‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ò‡∏µ‡∏°‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô:</label>
                    <div class="d-flex gap-2 flex-wrap">
                        <button class="btn btn-sm btn-outline-danger"
                            onclick="window.forceTheme('JP', 'sakura')">Sakura</button>
                        <button class="btn btn-sm btn-outline-info"
                            onclick="window.forceTheme('JP', 'winter')">Winter</button>
                        <button class="btn btn-sm btn-outline-primary"
                            onclick="window.forceTheme('JP', 'rainy')">Rainy</button>
                        <button class="btn btn-sm btn-outline-dark"
                            onclick="window.forceTheme('JP', 'hanabi')">Hanabi</button>
                        <button class="btn btn-sm btn-outline-warning"
                            onclick="window.forceTheme('JP', 'autumn')">Autumn</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>

</html>